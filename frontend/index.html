<!DOCTYPE html>
<html>

  <head>
    <title>Brax visualizer</title>
    <link rel="shortcut icon" type="image/x-icon" href="static/favicon.ico">
  </head>

  <style>
    body {
      margin: 0;
      padding: 0;
    }

    #brax-viewer {
      height: 100vh;
      width: 100vw;
      margin: 0;
      padding: 0;
    }
  </style>
  <script async src="https://unpkg.com/es-module-shims@1.6.3/dist/es-module-shims.js"></script>

  <script type="importmap">
    {
      "imports": {
        "three": "https://unpkg.com/three@0.150.1/build/three.module.js",
        "three/addons/": "https://unpkg.com/three@0.150.1/examples/jsm/",
        "lilgui": "https://cdn.jsdelivr.net/npm/lil-gui@0.18.0/+esm",
        "viewer": "/static/js/viewer.js"
      }
    }
  </script>

  <!-- <script src="https://unpkg.com/pako@2.1.0/dist/pako.min.js"></script> -->

  <script type="application/javascript">
  var system = '{"opt": {"timestep": 0.018000001087784767, "name": "Option"}, "link_names": ["cart", "pole"], "name": "System", "geoms": {"world": [{"name": "Capsule", "link_idx": -1, "pos": [0.0, 0.0, 0.0], "rot": [0.7071067690849304, 0.0, 0.7071067690849304, 0.0], "rgba": [1.0, 1.0, 1.0, 1.0], "size": [0.019999999552965164, 1.5, 0.0]}], "cart": [{"name": "Capsule", "link_idx": 0, "pos": [0.0, 0.0, 0.0], "rot": [0.7071067690849304, 0.0, 0.7071067690849304, 0.0], "rgba": [0.4, 0.33, 0.26, 1.0], "size": [0.10000000149011612, 0.10000000149011612, 0.0]}], "pole": [{"name": "Capsule", "link_idx": 1, "pos": [0.0005000000237487257, 0.0, 0.30000001192092896], "rot": [0.0008333324803970754, -0.0, -0.9999996423721313, 0.0], "rgba": [0.4, 0.33, 0.26, 1.0], "size": [0.04899999871850014, 0.3000004291534424, 0.0]}]}, "states": {"x": [{"pos": [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0]], "rot": [[1.0, 0.0, 0.0, 0.0], [0.9997408390045166, 0.0, 0.022764457389712334, 0.0]], "name": "Transform"}]}}';
  // // decode base64 (convert ascii to binary)
  // system = atob(system);
  // // convert binary string to character-number array
  // system = system.split('').map(function(x){return x.charCodeAt(0);});
  // // decompress
  // system = pako.inflate(system);
  // // convert gunzipped byteArray back to ascii string
  // system = new TextDecoder("utf-8").decode(system);
  // // and load json
  system = JSON.parse(system);
  </script>

<body>

  <div id="brax-viewer"></div>

  <script type="module">
    import {Viewer, setupLiveFrameWebSocket} from 'viewer';
    const domElement = document.getElementById("brax-viewer");
    var viewer = new Viewer(domElement, system);
    setupLiveFrameWebSocket(system, viewer);
  </script>

</body>

</html>